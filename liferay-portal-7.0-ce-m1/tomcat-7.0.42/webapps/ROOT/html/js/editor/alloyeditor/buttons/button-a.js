YUI.add("button-a",function(t){"use strict";var i=t.Lang,e=t.Node,n=t.Base.create("a",t.Plugin.Base,[t.ButtonBase],{initializer:function(){this._ckLink=new CKEDITOR.Link(this.get("host").get("editor"))},renderUI:function(){this._renderButtonUI(),this._renderLinkUI()},bindUI:function(){this.onHostEvent("visibleChange",this._onVisibleChange,this),this._linkInput.on("keypress",this._onKeyPress,this),this._linkInput.on("valuechange",this._onValueChange,this),this._showText.on("click",this._switchToTextMode,this),this._closeLink.on("click",this._onCloseLinkClick,this),this._clearInput.on("click",this._onClearInputClick,this)},updateUI:function(){var t,i,e,n;t=this.get("host").get("editor"),i=t.elementPath(),this._style&&(n=this._style.checkActive(i,t),this._button.set("pressed",!!n)),e=this._button.get("boundingBox").one("i"),this._button.get("pressed")?e.replaceClass("alloy-editor-icon-link","alloy-editor-icon-unlink"):e.replaceClass("alloy-editor-icon-unlink","alloy-editor-icon-link")},_adjustHostPosition:function(t){var i,e,n,s,o;s=this.get("host"),s.get("visible")&&(i=s.get("boundingBox").get("offsetWidth"),n=Math.abs((t-i)/2),e=s.get("xy"),o=t>i?e[0]+n:e[0]-n,s.set("xy",[o,e[1]]))},_attachHideHandler:function(){this._hideHandle=this.onceHostEvent("visibleChange",function(t){t.newVal||this._handleLink()},this)},_onClearInputClick:function(){this._linkInput.set("value",""),this._linkInput.focus(),this._clearInput.hide(),this._closeLink.disable()},_onCloseLinkClick:function(){this.get("host").hide()},_onClick:function(t){var i,e,n,s,o,l=this;i=t.target,e=l.get("host").get("editor"),i.get("pressed")?(o=e.getSelection(),n=this.get("host").get("boundingBox").get("offsetWidth"),l._buttonsContainer.addClass("hide"),l._linkContainer.removeClass("hide"),this._adjustHostPosition(n),s=l._linkInput,s.focus(),this._ckLink.create("/",{"data-cke-default-link":!0}),this._defaultLink=l._link=this._ckLink.getFromSelection(),this._attachHideHandler()):this._ckLink.remove()},_handleLink:function(){var t,i;i=this._linkInput.get("value"),t=this.get("host").get("editor"),i?(this._ckLink.update(i,this._link),this._link.removeAttribute("data-cke-default-link")):this._ckLink.remove(this._link),this._linkInput.set("value",""),this._link=null},_onKeyPress:function(t){13===t.charCode&&this.get("host").hide()},_onValueChange:function(t){t.newVal?(this._clearInput.show(),this._closeLink.enable()):(this._clearInput.hide(),this._closeLink.disable())},_onVisibleChange:function(t){var i,e;t.newVal?(i=this.get("host").get("editor"),e=this._ckLink.getFromSelection(),e?this._switchToLinkMode(e):this._switchToTextMode()):(this._linkContainer.addClass("hide"),this.get("host").get("buttonsContainer").removeClass("hide"),this._clearInput.hide(),this._closeLink.disable(),this._defaultLink=null)},_removeHideHandler:function(){this._hideHandle&&(this._hideHandle.detach(),this._hideHandle=null)},_renderLinkUI:function(){var n,s;s=e.create(i.sub(this.TPL_LINK_CONTAINER,{placeholder:this.get("strings").placeholder})),n=this.get("host").get("contentBox"),n.appendChild(s),this._buttonsContainer=this.get("host").get("buttonsContainer"),this._linkContainer=s,this._linkInput=s.one("input"),this._clearInput=s.one(".input-clear i"),this._clearInput.hide(),this._closeLink=new t.Button({disabled:!0,render:s.one(".input-close-container"),srcNode:s.one(".close-link")}),this._showText=new t.Button({render:s.one(".show-buttons-container"),srcNode:s.one(".switch-to-edit")})},_switchToTextMode:function(){var t,i,e,n,s;this._removeHideHandler(),this._defaultLink&&(e=this._linkInput.get("value"),e?this._handleLink():(i=this.get("host").get("editor"),s=i.getSelection(),t=s.createBookmarks(),this._handleLink(),s.selectBookmarks(t)),this._defaultLink=null,this.fire("actionPerformed")),n=this.get("host").get("boundingBox").get("offsetWidth"),this._linkContainer.addClass("hide"),this._buttonsContainer.removeClass("hide"),this._adjustHostPosition(n)},_switchToLinkMode:function(t){var i,e;i=this.get("host").get("editor"),t=t||this._ckLink.getFromSelection(),this._clearInput.show(),this._closeLink.disable(),this._buttonsContainer.addClass("hide"),this._linkContainer.removeClass("hide"),e=this._linkInput,e.set("value",t.$.href),setTimeout(function(){e.select(),e.focus()},0),this._link=t,this._attachHideHandler()},TPL_CONTENT:'<i class="alloy-editor-icon-link"></i>',TPL_LINK_CONTAINER:'<div class="link-wrapper hide"><div class="pull-left btn-group show-buttons-container"><button class="alloy-editor-button btn btn-default switch-to-edit"><i class="alloy-editor-icon-font"></i></button></div><div class="pull-left btn-group input-wrapper"><span class="input-container"><input class="input-large" type="text" placeholder="{placeholder}"></input><span class="input-clear"><i class="alloy-editor-icon-remove-small"></i></span></span></div><div class="pull-right btn-group input-close-container"><button class="alloy-editor-button btn btn-default close-link"><i class="alloy-editor-icon-ok"></i></button></div></div>'},{NAME:"a",NS:"a",ATTRS:{element:{validator:i.isString,value:"a"},strings:{value:{placeholder:"Type or paste link here"}}}});t.ButtonA=n},"",{requires:["button-base","event-valuechange"]});